{{ define "main" }}
<div class="grid-container">
    <!-- Schema Markup for the List of Events (ItemList) -->
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebPage",
            "mainEntity": {
                "@type": "ItemList",
                "name": "Exhibition Gallery",
                "itemListElement": [
                    {{ range $index, $page := where .Pages "Params.categories" "intersect" (slice "solo" "collab") }}
                        {{ if not $page.Params.noshow }} 
                        {
                            "@type": "ListItem",
                            "position": {{ add $index 1 }},
                            "url": "{{ $page.Permalink }}",
                            "name": "{{ $page.Title }}",
                            "description": "{{ $page.Params.description }}",
                            "startDate": "{{ $page.Params.dateof | slice 0 10 }}T00:00:00Z",
                            "endDate": "{{ $page.Params.dateof | slice 13 23 }}T23:59:59Z",
                            "location": {
                                "@type": "Place",
                                "name": "{{ $page.Params.place }}",
                                "address": {
                                    "@type": "PostalAddress",
                                    "addressLocality": "Sofia",
                                    "addressCountry": "Bulgaria"
                                }
                            },
                            "performer": {
                                "@type": "Person",
                                "name": "Nikola Stoyanov"
                            },
                            "organizer": {
                                "@type": "Person",
                                "name": "Nikola Stoyanov"
                            },
                            "image": "{{ with $page.Resources.GetMatch "hero.webp" }}{{ .RelPermalink }}{{ else }}{{ .Site.BaseURL }}images/default-hero.jpg{{ end }}"
                        }
                        {{ $lastIndex := sub (len .Pages) 1 }}
                        {{ if not (eq $index $lastIndex) }},{{ end }}
                        {{ end }}
                    {{ end }}
                ]
            }
        }
        </script>
        

    <!-- Exhibition Cards (for Frontend display) -->
    {{ $taggedPages := where .Pages "Params.categories" "intersect" (slice "solo" "collab") }}
    {{ range $taggedPages }}
        {{ if not .Params.noshow }} <!-- Check if noshow parameter is not true -->
            <div class="grid-card">
                <a href="{{ .Permalink }}">
                    <!-- Hero Image from Post Bundle -->
                    {{ with .Resources.GetMatch "hero.webp" }}
                        {{ $heroImg := .Resize "600x" }}
                        <img src="{{ $heroImg.RelPermalink }}" alt="{{ with .Params.description }}{{ .Params.description }}{{ else }}{{ .Title }}{{ end }}" class="card-image">
                    </a>
                    {{ end }}

                    <div class="card-content">
                        <a href="{{ .Permalink }}">
                            <h1 class="card-title">{{ .Title }} {{ dateFormat "(2006)" .Date }}</h1>
                        </a>
                    </div>
                </a>
            </div>
        {{ end }}
    {{ end }}
</div>
{{ end }}
